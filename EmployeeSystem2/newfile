Improved version with user input
